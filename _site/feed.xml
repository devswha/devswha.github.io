<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.10.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2024-08-17T20:57:34+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">AI ì¹œêµ¬ ë§Œë“¤ê¸° ëŒ€ì‘ì „</title><subtitle>devswha blog</subtitle><author><name>Sangwoo Ha</name><email>devswha@gmail.com</email></author><entry><title type="html">í° ìˆ˜ì˜ ë²•ì¹™</title><link href="http://localhost:4000/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/%ED%81%B0-%EC%88%98%EC%9D%98-%EB%B2%95%EC%B9%99/" rel="alternate" type="text/html" title="í° ìˆ˜ì˜ ë²•ì¹™" /><published>2024-08-15T00:00:00+09:00</published><updated>2024-08-17T00:00:00+09:00</updated><id>http://localhost:4000/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/%ED%81%B0%20%EC%88%98%EC%9D%98%20%EB%B2%95%EC%B9%99</id><content type="html" xml:base="http://localhost:4000/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/%ED%81%B0-%EC%88%98%EC%9D%98-%EB%B2%95%EC%B9%99/"><![CDATA[<h3 id="-ë¬¸ì œ">ğŸ”” ë¬¸ì œ</h3>

<p>â€˜í° ìˆ˜ì˜ ë²•ì¹™â€™ì€ ì¼ë°˜ì ìœ¼ë¡œ í†µê³„ ë¶„ì•¼ì—ì„œ ë‹¤ë£¨ì–´ì§€ëŠ” ë‚´ìš©ì´ì§€ë§Œ ë™ë¹ˆì´ëŠ” ë³¸ì¸ë§Œì˜ ë°©ì‹ìœ¼ë¡œ ë‹¤ë¥´ê²Œ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ë™ë¹ˆì´ì˜ í° ìˆ˜ì˜ ë²•ì¹™ì€ ë‹¤ì–‘í•œ ìˆ˜ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì´ ìˆì„ ë•Œ ì£¼ì–´ì§„ ìˆ˜ë“¤ì„ Më²ˆ ë”í•˜ì—¬ ê°€ì¥ í° ìˆ˜ë¥¼ ë§Œë“œëŠ” ë²•ì¹™ì´ë‹¤. ë‹¨, ë°°ì—´ì˜ íŠ¹ì •í•œ ì¸ë±ìŠ¤(ë²ˆí˜¸)ì— í•´ë‹¹í•˜ëŠ” ìˆ˜ê°€ ì—°ì†í•´ì„œ Kë²ˆì„ ì´ˆê³¼í•˜ì—¬ ë”í•´ì§ˆ ìˆ˜ ì—†ëŠ” ê²ƒì´ ì´ ë²•ì¹™ì˜ íŠ¹ì§•ì´ë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ ìˆœì„œëŒ€ë¡œ 2,4,5,4,6ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì´ ìˆì„ ë•Œ Mì´ 8ì´ê³ , Kê°€ 3ì´ë¼ê³  ê°€ì •í•˜ì. ì´ ê²½ìš° íŠ¹ì •í•œ ì¸ë±ìŠ¤ì˜ ìˆ˜ê°€ ì—°ì†í•´ì„œ ì„¸ ë²ˆê¹Œì§€ë§Œ ë”í•´ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ í° ìˆ˜ì˜ ë²•ì¹™ì— ë”°ë¥¸ ê²°ê³¼ëŠ” 6+6+6+5+6+6+6+5ì¸ 46ì´ ëœë‹¤.</p>

<p>ë‹¨, ì„œë¡œ ë‹¤ë¥¸ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ìˆ˜ê°€ ê°™ì€ ê²½ìš°ì—ë„ ì„œë¡œ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ê°„ì£¼í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìˆœì„œëŒ€ë¡œ 3,4,3,4,3ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì´ ìˆì„ ë•Œ Mì´ 7ì´ê³ , Kê°€ 2ë¼ê³  ê°€ì •í•˜ì. ì´ ê²½ìš° ë‘ ë²ˆì§¸ ì›ì†Œì— í•´ë‹¹í•˜ëŠ” 4ì™€ ë„¤ ë²ˆì¬ ì›ì†Œì— í•´ë‹¹í•˜ëŠ” 4ë¥¼ ë²ˆê°ˆì•„ ë‘ ë²ˆì”© ë”í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ 4+4+4+4+4+4+4ì¸ 28ì´ ë„ì¶œëœë‹¤. ë°°ì—´ì˜ í¬ê¸° N, ìˆ«ìê°€ ë”í•´ì§€ëŠ” íšŸìˆ˜ M, ê·¸ë¦¬ê³  Kê°€ ì£¼ì–´ì§ˆ ë•Œ ë™ë¹ˆì´ì˜ í° ìˆ˜ì˜ ë²•ì¹™ì— ë”°ë¥¸ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ì‹œì˜¤.</p>

<h3 id="ì…ë ¥">ì…ë ¥</h3>

<p>ì²«ì§¸ ì¤„ì— N(2&lt;=N&lt;=1,000), M(1&lt;=M&lt;=10,000), K(1&lt;=K&lt;=10,000)ì˜ ìì—°ìˆ˜ê°€ ì£¼ì–´ì§€ë©°, ê° ìì—°ìˆ˜ëŠ” ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤.</p>

<p>ë‘˜ì§¸ ì¤„ì— Nê°œì˜ ìì—°ìˆ˜ê°€ ì£¼ì–´ì§„ë‹¤. ê° ìì—°ìˆ˜ëŠ” ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤. ë‹¨, ê°ê°ì˜ ìì—°ìˆ˜ëŠ” 1ì´ìƒ 10,000 ì´í•˜ì˜ ìˆ˜ë¡œ ì£¼ì–´ì§„ë‹¤.</p>

<p>ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§€ëŠ” KëŠ” í•­ìƒ Më³´ë‹¤ ì‘ê±°ë‚˜ ê°™ë‹¤.</p>

<h3 id="ì¶œë ¥">ì¶œë ¥</h3>

<p>ì²«ì§¸ ì¤„ì— ë™ë¹ˆì´ì˜ í° ìˆ˜ì˜ ë²•ì¹™ì— ë”°ë¼ ë”í•´ì§„ ë‹µì„ ì¶œë ¥í•œë‹¤.</p>

<h3 id="ì…ì¶œë ¥-ì˜ˆì‹œ">ì…ì¶œë ¥ ì˜ˆì‹œ</h3>
<p>5 8 3
2 4 5 4 6
ì¶œë ¥: 46</p>

<h3 id="-í’€ì´ë°©ë²•">ğŸ¯ í’€ì´ë°©ë²•</h3>

<p>ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ì¼ë‹¨ ì…ë ¥ê°’ ì¤‘ì—ì„œ ê°€ì¥ í° ìˆ˜ì™€ ë‘ ë²ˆì§¸ë¡œ í° ìˆ˜ë§Œ ì €ì¥í•˜ë©´ ëœë‹¤. ì—°ì†ìœ¼ë¡œ ë”í•  ìˆ˜ ìˆëŠ” íšŸìˆ˜ëŠ” ìµœëŒ€ Kë²ˆì´ë¯€ë¡œ  â€˜ê°€ì¥ í° ìˆ˜ë¥¼ Kë²ˆ ë”í•˜ê³  ë‘ë²ˆì§¸ë¡œ í° ìˆ˜ë¥¼ í•œ ë²ˆ ë”í•˜ëŠ” ì—°ì‚°â€™ì„ ë°˜ë³µí•˜ë©´ ëœë‹¤.</p>

<h3 id="ì˜ˆì‹œ-ì„¤ëª…">ì˜ˆì‹œ ì„¤ëª…</h3>
<p>ì²«ì§¸ ì¤„ ì…ë ¥: N(ë°°ì—´ì˜ í¬ê¸°), M(ëª‡ë²ˆ ë” í• ê±´ì§€), K(í•œ ìˆ«ìë‹¹ ìµœëŒ€ ì—°ì†ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ê°œìˆ˜) -&gt; 5, 8, 3
ë‘ë²ˆì§¸ ì¤„ ì…ë ¥: N ê°œì˜ ìì—°ìˆ˜ -&gt; 2 4 5 4 6
8ë²ˆ ë”í•˜ê³ , ìµœëŒ€ 3ê°œê¹Œì§€ ê°€ëŠ¥í•˜ë¯€ë¡œ ê°€ì¥ í° ìˆœì„œëŒ€ë¡œ 6+6+6+5+6+6+6+5 = 46</p>

<h3 id="-python-ì½”ë“œ">ğŸ’» Python ì½”ë“œ</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())</span> <span class="c1"># ë°°ì—´ í¬ê¸°, ë”í•´ì§€ëŠ” íšŸìˆ˜, ì—°ì† ëª‡ë²ˆê¹Œì§€
</span><span class="n">numbers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">first</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># ê°€ì¥ í° ìˆ˜
</span><span class="n">second</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># ë‘ë²ˆì§¸ë¡œ í° ìˆ˜
</span>
<span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">answer</span> <span class="o">+=</span> <span class="n">first</span>
        <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">answer</span> <span class="o">+=</span> <span class="n">second</span>
    <span class="n">m</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="-ì‹¬í™”">ğŸ’¡ ì‹¬í™”</h3>
<p>Mì˜ í¬ê¸°ê°€ 100ì–µ ì´ìƒì²˜ëŸ¼ ë†’ì€ ìˆ«ìë¼ë©´ while true ì•ˆì˜ m==0 ì´ ë ë•Œê¹Œì§€ M ìˆ«ìë§Œí¼ ì—°ì‚°ì´ ë°˜ë³µëœë‹¤. í•˜ì§€ë§Œ ë°˜ë³µë˜ëŠ” ìˆ˜ì—´ì„ íŒŒì•…í•œë‹¤ë©´, Më²ˆì˜ ì—°ì‚° ì—†ì´ êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë‹¤. ì˜ˆì‹œë¥¼ ë³´ë©´, ë°˜ë³µë˜ëŠ” ìˆ˜ì—´ì´ [6,6,6,5] ê°€ ë°˜ë³µì´ ëœë‹¤. 
ì¦‰, ê°€ì¥ í° ìˆ˜ë¥¼ X ë¼ í•˜ê³  ë‘ ë²ˆì§¸ë¡œ í° ìˆ˜ë¥¼ x ë¼ í•  ë•Œ, [X,X,X,x] ê°€ ë°˜ë³µëœë‹¤. ê·¸ë ‡ë‹¤ë©´ ì´ ë°˜ë³µë˜ëŠ” ìˆ˜ì—´ì˜ íšŸìˆ˜ëŠ” M / (K+1) ì´ ëœë‹¤. ê·¸ë¦¬ê³  ì´ ìˆ˜ì—´ì—ì„œ ê°€ì¥ í° ìˆ«ìëŠ” Kë²ˆ, ë‹¤ìŒ í° ìˆ«ìëŠ” 1ë²ˆ ë°˜ë³µëœë‹¤. 
ë”°ë¼ì„œ ê°€ì¥ í° ìˆ˜ X ê°€ ë‚˜ì˜¬ íšŸìˆ˜ëŠ” (M/(K+1))*K + M%(K+1), ì´ ë˜ê³  ì´ íšŸìˆ˜ë¥¼ M ì—ì„œ ëº€ ê²ƒì´ ë‘ ë²ˆì§¸ë¡œ í° ìˆ˜ x ê°€ ë‚˜ì˜¬ íšŸìˆ˜ì´ë‹¤. ì´ë¥¼ ì½”ë“œë¡œ êµ¬í˜„í•˜ë©´</p>

<h3 id="-ê°œì„ ëœ-python-ì½”ë“œ">ğŸ’» ê°œì„ ëœ Python ì½”ë“œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">first</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">second</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">k</span>
<span class="n">count</span> <span class="o">+=</span> <span class="n">m</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">answer</span> <span class="o">+=</span> <span class="n">count</span> <span class="o">*</span> <span class="n">first</span>
<span class="n">answer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">count</span><span class="p">)</span> <span class="o">*</span> <span class="n">second</span>

<span class="k">print</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
</code></pre></div></div>]]></content><author><name>Sangwoo Ha</name><email>devswha@gmail.com</email></author><category term="ì•Œê³ ë¦¬ì¦˜" /><category term="ê·¸ë¦¬ë”” ì•Œê³ ë¦¬ì¦˜" /><summary type="html"><![CDATA[ğŸ”” ë¬¸ì œ]]></summary></entry><entry><title type="html">[ë…¼ë¬¸ë¿Œì…”ë¨¹ê¸°] MaskFormer: Per-Pixel Classification is Not All You Need for Semantic Segmentation</title><link href="http://localhost:4000/%EB%85%BC%EB%AC%B8%EB%BF%8C%EC%85%94%EB%A8%B9%EA%B8%B0/YOLO/" rel="alternate" type="text/html" title="[ë…¼ë¬¸ë¿Œì…”ë¨¹ê¸°] MaskFormer: Per-Pixel Classification is Not All You Need for Semantic Segmentation" /><published>2021-12-29T00:00:00+09:00</published><updated>2024-08-15T00:00:00+09:00</updated><id>http://localhost:4000/%EB%85%BC%EB%AC%B8%EB%BF%8C%EC%85%94%EB%A8%B9%EA%B8%B0/YOLO</id><content type="html" xml:base="http://localhost:4000/%EB%85%BC%EB%AC%B8%EB%BF%8C%EC%85%94%EB%A8%B9%EA%B8%B0/YOLO/"><![CDATA[<blockquote>
  <p>NeurIPS 2021. [<a href="https://arxiv.org/abs/2107.06278">Paper</a>] [<a href="https://bowenc0221.github.io/maskformer/">Page</a>] [<a href="https://github.com/facebookresearch/MaskFormer">Github</a>]<br />
Bowen Cheng, Alexander G. Schwing, Alexander Kirillov<br />
Facebook AI Research (FAIR) | University of Illinois at Urbana-Champaign (UIUC)<br />
13 Jul 2021</p>
</blockquote>]]></content><author><name>Sangwoo Ha</name><email>devswha@gmail.com</email></author><category term="ë…¼ë¬¸ë¿Œì…”ë¨¹ê¸°" /><summary type="html"><![CDATA[Maskformer ë…¼ë¬¸ ë¦¬ë·°]]></summary></entry><entry><title type="html">Segmentation using Unet with Keras and Jupyter Notebook</title><link href="http://localhost:4000/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/keras-unet/" rel="alternate" type="text/html" title="Segmentation using Unet with Keras and Jupyter Notebook" /><published>2021-09-29T00:00:00+09:00</published><updated>2019-09-29T00:00:00+09:00</updated><id>http://localhost:4000/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/keras-unet</id><content type="html" xml:base="http://localhost:4000/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/keras-unet/"><![CDATA[<blockquote>
  <p>The implementation of biomedical image segmentation with the use of U-Net model with Keras and Jupyter Notebook. The architecture was inspired by <a href="http://lmb.informatik.uni-freiburg.de/people/ronneber/u-net/">U-Net: Convolutional Networks for Biomedical Image Segmentation</a>. And I mainly referred to the images and codes of these github: <a href="https://github.com/zhixuhao/unet">zhixuhao github</a> and <a href="https://github.com/ugent-korea/pytorch-unet-segmentation">ugent-korea github</a></p>
</blockquote>

<h2 id="abstract">Abstract</h2>

<p>The author of paper propose a simple and effective end-to-end image segmentation network architecture for medical images.
The proposed network, called U-net, has main three factors for well-training.</p>
<ul>
  <li>U-shaped network structure with two configurations: Contracting and Expanding path</li>
  <li>Training more faster than sliding-windows: Patch units and Overlap-tile</li>
  <li>Data augmentation: Elastic deformation and Weight cross entropy</li>
</ul>

<h2 id="dataset">Dataset</h2>

<p>The dataset we used is Transmission Electron Microscopy (ssTEM) data set of the Drosophila first instar larva ventral nerve cord (VNC), which is dowloaded from <a href="http://brainiac2.mit.edu/isbi_challenge/home">ISBI Challenge: Segmentation of of neural structures in EM stacks</a></p>

<p><img src="http://localhost:4000/assets/images/keras-Unet/ISBI.gif" alt="ISBI" class="align-center" /></p>

<ul>
  <li>Black and white segmentation of membrane and cell with EM(Electron Microscopic) image.</li>
  <li>The data set is a large size of image and few so the data augmentation is needed.</li>
  <li>The data set contains 30 images of size 512x512 for the train, train-labels and test.</li>
  <li>There is no images for test-labels for the ISBI competition.</li>
  <li>If you want to get the evaluation metrics of competition, you should split part of the train data set for testing.</li>
</ul>

<h2 id="overlap-tile">Overlap-tile</h2>

<p><img src="http://localhost:4000/assets/images/keras-Unet/sliding_window.png" alt="sliding_window" class="align-center" /></p>

<p><img src="http://localhost:4000/assets/images/keras-Unet/patch.png" alt="patch" class="align-center" /></p>

<ul>
  <li>Patch method has low overlap ratio so that the speed of detection can be improvement.</li>
  <li>However, as the wide size of patch detect image at once, the performance of context is good but the performance of localization is lower.</li>
  <li>In this paper, the U-net architecture and overlap-tile methods were proposed to solve this localization problem.</li>
</ul>

<p><img src="http://localhost:4000/assets/images/keras-Unet/overlap_tile.png" alt="overlap_tile" class="align-center" /></p>

<p>Simple. Because the EM image is large, sometimes the model of detection input is larger than the patch size (yellow). If so, mirror and fill in the patch area with the empty part.</p>

<h2 id="data-augmenation">Data Augmenation</h2>

<p>We preprocessed the images for data augmentation. Following preprocessing are :</p>
<ul>
  <li>Flip</li>
  <li>Gaussian noise</li>
  <li>Uniform noise</li>
  <li>Brightness</li>
  <li>Elastic deformation</li>
  <li>Crop</li>
  <li>Pad</li>
</ul>

<p>You can easily to understand refer this <a href="https://github.com/ugent-korea/pytorch-unet-segmentation/blob/master/README.md#preprocessing">page</a></p>

<p align="center"><img width="250" height="250" src="/assets/images/keras-Unet/readme_images/original.png" /> <br />Original Image</p>
<table border="0" width="99%">
	<tbody> 
		<tr>		
			<td width="99%" align="center" colspan="4"><strong>Image</strong></td>
		</tr>
		<tr>
			<td width="19%" align="center"> Flip  </td> 
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/flip_vert" /> <br />Vertical  </td> 
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/flip_hori" />  <br />Horizontal</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/flip_both" /> <br />Both</td>
		</tr>
		<tr>
			<td width="19%" align="center"> Gaussian noise </td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/gn_10" /> <br />Standard Deviation: 10</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/gn_50" /> <br />Standard Deviation: 50</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/gn_100" /> <br />Standard Deviation: 100</td>
		</tr>
		<tr>
			<td width="19%" align="center"> Uniform noise </td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/uniform_10" /> <br />Intensity: 10 </td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/un_50" /> <br />Intensity: 50</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/un_100" /> <br />Intensity: 100</td>
		</tr>
		<tr>
			<td width="19%" align="center"> Brightness </td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/bright_10" /> <br />Intensity: 10</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/br_50.png" /> <br />Intensity: 20</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/br_100.png" /> <br />Intensity: 30</td>
		</tr>
		<tr>
			<td width="19%" align="center"> Elastic deformation </td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/ed_10.png" /> <br />Random Deformation: 1</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/ed_34.png" /> <br />Random Deformation: 2</td>
			<td width="27%" align="center"> <img src="/assets/images/keras-Unet/readme_images/ed_50.png" /> <br />Random Deformation: 3</td>
		</tr>
	</tbody>
</table>
<h3 id="crop-and-pad">Crop and Pad</h3>
<table border="0" width="99%">
	<tbody> 
    	<tr>		
			<td width="99%" align="center" colspan="4"><strong>Crop</strong></td>
	    </tr>
		<tr>
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/c_lb" /> <br />  Left Bottom </td>
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/c_lt" /> <br /> Left Top</td> 
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/c_rb" /> <br /> Right Bottom</td>
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/c_rt" /> <br /> Right Top</td> 
		</tr>
	</tbody>
</table>

<p>Padding process is compulsory after the cropping process as the image has to fit the input size of the U-Net model.</p>

<p>In terms of the padding method, <strong>symmetric padding</strong> was done in which the pad is the reflection of the vector mirrored along the edge of the array. We selected the symmetric padding over several other padding options because it reduces the loss the most.</p>

<p>To help with observation, a <span style="color:black; background-color:yellow;">yellow border</span> is added around the original image: outside the border indicates symmetric padding whereas inside indicates the original image.</p>

<table border="0" width="99%">
	<tbody> 
    	<tr>		
			<td width="99%" align="center" colspan="4"><strong>Pad</strong></td>
	    </tr>
		<tr>
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/p_lb.PNG" /> <br />  Left Bottom </td>
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/p_lt.PNG" /> <br /> Left Top</td> 
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/p_rb.PNG" /> <br /> Right bottom</td>
			<td width="25%" align="center"> <img src="/assets/images/keras-Unet/readme_images/p_rt.PNG" /> <br /> Right Top</td> 
		</tr>
	</tbody>
</table>

<h2 id="network-architecture">Network Architecture</h2>

<p align="center">
    <img src="/assets/images/keras-Unet/unet.png" width="70%" height="70%" />
</p>

<h3 id="contracting-path-fully-convolution">Contracting Path (Fully Convolution)</h3>
<ul>
  <li>Typical convolutional network.</li>
  <li>3x3 convolution layer with max-pooling and drop out</li>
  <li>Extracts the image feature accurately, but reduces the size of the image feature map.</li>
</ul>

<h3 id="expanding-path-deconvolution">Expanding Path (Deconvolution)</h3>
<ul>
  <li>Output segmentation map by upsampling the feature map</li>
  <li>2x2 up-convolution and 3x3 convolution layer with concatenation</li>
  <li>The disadvantage of upsampling process is that the localization information in the image feature map will be lost.</li>
  <li>Therefore, localization information less lost by concatenating the feature map after up-conv with the same level feature map.</li>
  <li>Last one is 1x1 convolution mapping</li>
</ul>

<h2 id="result">Result</h2>

<p align="center">
    <img src="/assets/images/keras-Unet/result.gif" width="100%" height="100%" />
</p>

<h2 id="usage">Usage</h2>
<p>When you download my code, your directory tree should consist of the following</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keras-Unet/
â”œâ”€â”€ data
    â”œâ”€â”€ test-volume.tif
    â”œâ”€â”€ train-labels.tif
    â””â”€â”€ train-volume.tif
â”œâ”€â”€ images
â”œâ”€â”€ jupyter.ipynb
â”œâ”€â”€ augmentation.py
â”œâ”€â”€ model.py
â”œâ”€â”€ preprocessing.py
â”œâ”€â”€ README.md
â”œâ”€â”€ train.py
â”œâ”€â”€ utills.py
â””â”€â”€ requirement.txt
</code></pre></div></div>
<p>You can change the root directory of data to change the <em>data_path</em> in pre-processing.py and augmentation.py</p>

<p>However, at least three original competition data (test-volume, train-labels, train-volume) should put in the <em>data_path</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3 augmentation.py
<span class="nv">$ </span>python3 preprocessing.py
<span class="nv">$ </span>python3 train.py
</code></pre></div></div>

<p>Easly to use my program just run augmentation-preprocessing-train step.
You can get the prediction.tif for the result.</p>

<p>And you can just run the <strong>jupyter.ipynb</strong> with <a href="https://jupyter.org/">jupyter notebook</a> to see how U-net works.</p>

<h2 id="github-link">Github link</h2>
<p><a href="https://github.com/devswha/keras-Unet">Segmentation using Unet with Keras and Jupyter Notebook</a></p>]]></content><author><name>Sangwoo Ha</name><email>devswha@gmail.com</email></author><category term="í”„ë¡œê·¸ë˜ë°" /><category term="Unet" /><summary type="html"><![CDATA[The implementation of biomedical image segmentation with the use of U-Net model with Keras and Jupyter Notebook]]></summary></entry></feed>